/**** Start of imports. If edited, may not auto-convert in the playground. ****/
var peat = ee.Image("users/mjlara71/AlbersPeatMap_v3Final"),
    AKbound = ee.FeatureCollection("users/mjlara71/AK_projected_bound");
/***** End of imports. If edited, may not auto-convert in the playground. *****/

/*
////////////////////////////////////////////////////////////////////////////////////////
                             Alaska Peatland Map (2019-2021)
/////////////////////////////////////////////////////////////////////////////////////////
Mark J Lara, Roger Michaelides, Duncan Anderson, Wenqu Chen, Emma Hall, Caroline Ludden,
Aiden Schore, Umakant Mishra, & Sarah Scott. (2023). Alaska Peatland Map (2019-2021). 
Arctic Data Center. doi:10.18739/A2NK3667M.

Peatlands cover 3% of the global land surface, yet store 25% of the worldâ€™s soil organic carbon. 
These organic-rich soils are widespread across permafrost regions, representing nearly 18% of land 
surface and storing between 500 and 600 petagrams of carbon (PgC). Peat (i.e., partially decomposed 
thick organic layers) accumulates due to the imbalance between plant production and decomposition 
often within saturated, nutrient deficient, and acidic soils, which limit decomposition. As warmer 
and drier conditions become more prevalent across northern ecosystems, the vulnerability of peatland 
oils may increase with the susceptibility of peat-fire ignitions, yet the distribution of peatlands 
across Alaska remains uncertain. Here we develop a new high-resolution (20 meter (m) resolution) 
wall-to-wall ~1.5 million square kilometer (km2) peatland map of Alaska, using a combination of Sentinel-1 
(Dual-polarized Synthetic Aperture Radar), Sentinel-2 (Multi-Spectral Imager), and derivatives from the 
Arctic Digital Elevation Model (ArcticDEM). Machine learning classifiers were trained and tested using peat cores, 
ground observations, and sub-meter resolution image interpretation, which was spatially constrained by a 
peatland suitability model that described the extent of terrain suitable for peat accumulation. This 
product identifies peatlands in Polar, Boreal, and Maritime ecoregions in Alaska to cover 26,842 
(4.6%), 69,783 (10.4%), and 13,506 (5.3%) km2, respectively.

*/

// BASE MAP SETTING

// Define base map style.
var basemapStyle = [
   {stylers: [{saturation: 0}, {lightness: 0}]
  }
];

// Set basemap options.
Map.setOptions('Satellite', {
    Satellite: basemapStyle
});

//Visualization
var palettes = require('users/gena/packages:palettes');
var palette = palettes.cmocean.Haline[7];

// Specify the class value to be made transparent (e.g., class 3)
var classToMask = 0;

// Create a mask where the unwanted class is set to 0 and others to 1
var mask = peat.neq(classToMask);

// Apply the mask to the classified image
var maskedClassifiedImage = peat.updateMask(mask);
//blue is no peat; yellow is moist peat; and green is wet peat
Map.addLayer(maskedClassifiedImage.clip(AKbound), {min:0, max:2, palette: palette}, "AK Peatland Map")
Map.setCenter(-164.1893, 62.9552, 10)
